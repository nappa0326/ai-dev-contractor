# CLAUDE.md - AI開発請負システム ガイドライン

## 🚨 最重要：ブランチ管理による連続性の保証

### 絶対的ルール
**各Issue/PRに対して単一のブランチのみを使用し、フェーズ間の連続性を必ず保証すること**

### 開発フェーズ記録

#### 現在進行中のプロジェクト
<!-- ここに各プロジェクトの進行状況を記録 -->

#### Issue別ブランチマッピング
<!-- 
例：
- Issue #24: claude/issue-24-20250712_012315
- Issue #25: claude/issue-25-20250712_042044
- Issue #26: claude/issue-26-20250712_103859
-->

### ブランチ管理手順（毎回必ず実行）

```bash
# 1. 作業開始時、必ず既存ブランチを確認
git fetch --all
git branch -a | grep "issue-{現在のissue番号}"

# 2. 既存ブランチが存在する場合
git checkout {既存ブランチ名}
git pull origin {既存ブランチ名}

# 3. 前のフェーズの実装を確認
git log --oneline -10  # コミット履歴を確認
ls -la  # ファイル構造を確認
# 主要ファイルの内容を読み込んで理解する

# 4. 新規ブランチは初回のみ作成
git checkout -b claude/issue-{issue_number}-{timestamp}
```

## プロジェクトディレクトリの作成ルール

### 絶対的ルール
**Phase 1で必ずプロジェクト専用ディレクトリを作成すること**

### ディレクトリ命名規則
- プロジェクト名を英語のkebab-caseに変換
- 日本語プロジェクト名は適切な英語名に翻訳
- 例：
  - "PDF圧縮デスクトップアプリ" → `pdf-compressor/`
  - "画像OCR・ドキュメント変換Webサービス" → `ocr-document-service/`
  - "Markdown変換デスクトップアプリ" → `markdown-converter/`

### ディレクトリ作成手順
```bash
# Phase 1開始時に必ず実行
mkdir {project-name}
cd {project-name}
# README.mdを作成して初期コミット
echo "# {プロジェクト名}" > README.md
```

## 開発プロセス

### フェーズ型開発の厳守

新規プロジェクト開始時は、**必ず**以下のフェーズに従って開発を進めてください：

1. **Phase 1 (20%)**: 設計書・アーキテクチャドキュメントを作成
   - **プロジェクト専用ディレクトリを作成**
   - 技術選定の理由を明記
   - ディレクトリ構造の提案
   - ブランチ名: `claude/issue-{番号}-{タイムスタンプ}`を作成
   - **報告に必ずブランチ名を含める**
   - `@claude-review-needed`タグを必ず含める

2. **Phase 2 (50%)**: MVP（最小限の動作可能な実装）を作成
   - **Phase 1と同じブランチを使用**
   - Phase 1の設計に基づいて実装
   - 既存ファイルがあれば読み込んで理解
   - コア機能のみ実装
   - **報告例**: "Phase 2完了 (branch: claude/issue-24-20250712_012315)"
   - `@claude-review-needed`タグを必ず含める

3. **Phase 3 (80%)**: 完全実装
   - **Phase 1,2と同じブランチを使用**
   - Phase 2のコードを拡張（削除・置換しない）
   - すべての要求機能を実装
   - エラーハンドリング、テスト追加
   - **前のフェーズのファイルを必ず読み込む**
   - `@claude-review-needed`タグを必ず含める

4. **Phase 4 (100%)**: 完成とPR作成
   - **Phase 1,2,3と同じブランチを使用**
   - ドキュメント整備
   - 最終的な品質確認
   - プルリクエストを作成
   - **必須**: Phase 4完了後、別コメントで【PHASE4_COMPLETE】のみを投稿（完了通知用）

### 連続性保証のチェックリスト

各フェーズ開始時に必ず確認：
- [ ] 既存ブランチの存在確認をしたか？
- [ ] 前のフェーズのコミットを確認したか？
- [ ] 前のフェーズのファイルを読み込んだか？
- [ ] 既存実装の上に追加実装する計画か？
- [ ] ブランチ名を報告に含めたか？

### 🚨 各フェーズ完了時の必須作業

**絶対に忘れてはいけない手順**：
```bash
# 1. すべての変更をステージング
git add -A

# 2. フェーズ完了をコミット
git commit -m "feat: Phase X implementation for Issue #XX"

# 3. リモートにプッシュ（これが最重要！）
git push origin {現在のブランチ名}
```

**なぜプッシュが必須なのか**：
- プッシュしないと、次回実行時に既存ブランチが見つからない
- 結果として新しいブランチが作成され、連続性が失われる
- 作業内容が失われ、フェーズの継続ができなくなる

### 禁止事項

- ❌ フェーズごとに新しいブランチを作成すること
- ❌ 前のフェーズの実装を無視すること
- ❌ 既存ファイルを削除してゼロから作り直すこと
- ❌ git履歴を確認せずに作業を開始すること

### エラー時の対処

- ブランチが見つからない場合は、ユーザーに確認を求める
- 勝手に新しいブランチを作成しない
- エラーメッセージを明確に報告し、次のアクションを提案する

### コミュニケーション

- 各フェーズの成果物を明確に説明する
- 次のフェーズで何を実装するか予告する
- 技術的な選択の理由を説明する